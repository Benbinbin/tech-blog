(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{1288:function(_,v,e){"use strict";e.r(v);var s=e(18),t=Object(s.a)({},(function(){var _=this,v=_.$createElement,s=_._self._c||v;return s("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[s("p",[_._v("参考：")]),_._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.postgresql.org/docs/current/release.html",target:"_blank",rel:"noopener noreferrer"}},[_._v("https://www.postgresql.org/docs/current/release.html"),s("OutboundLink")],1)]),_._v(" "),s("li",[s("a",{attrs:{href:e(808)}},[_._v("PostgreSQL 12.3 Documentation")])])]),_._v(" "),s("p",[_._v("psql 是 PostgreSQL shell，可以输入 sql 代码并立即执行获得反馈，通过命令行的方式与数据库进行交互。")]),_._v(" "),s("h2",{attrs:{id:"常用操作命令"}},[_._v("常用操作命令")]),_._v(" "),s("p",[_._v("⚠️ 复合的命令可以换行输入，而在最后使用 "),s("code",[_._v(";")]),_._v(" 以表示命令结束，否则会报错。")]),_._v(" "),s("h3",{attrs:{id:"l-命令"}},[_._v("\\l 命令")]),_._v(" "),s("p",[_._v("命令 "),s("code",[_._v("\\l")]),_._v(" 列出所有数据库")]),_._v(" "),s("h3",{attrs:{id:"d-命令"}},[_._v("\\d 命令")]),_._v(" "),s("p",[_._v("以 "),s("code",[_._v("\\d")]),_._v(" 为关键字的命令用于查看当前数据库内数据（一般时表格）的匹配关系")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("\\d")]),_._v(" 列出当前数据库中的所有表，包括所属数据库的 schema 架构模式，name 表格名称，type 表格类型，owner 表格拥有者")]),_._v(" "),s("li",[s("code",[_._v("\\d+")]),_._v(" 显示更多信息")]),_._v(" "),s("li",[s("code",[_._v("\\d table_name;")]),_._v(" 显示名字为 name 的表的相关结构定义")]),_._v(" "),s("li",[s("code",[_._v("\\d tableName_pkey;")]),_._v(" 显示指定表格的的索引（主键 primary key）信息")]),_._v(" "),s("li",[s("code",[_._v("\\d")]),_._v(" 使用通配符 "),s("code",[_._v("*")]),_._v(" 或 "),s("code",[_._v("?")]),_._v(" 筛选显示名称符合特定模式的表\n"),s("ul",[s("li",[s("code",[_._v("*")]),_._v(" 模糊匹配，不限制字数")]),_._v(" "),s("li",[s("code",[_._v("?")]),_._v(" 模糊匹配，一个字符")])])])]),_._v(" "),s("p",[_._v("显示特定类型的信息")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("\\dt")]),_._v(" 只显示表")]),_._v(" "),s("li",[s("code",[_._v("\\di")]),_._v(" 只显示索引")]),_._v(" "),s("li",[s("code",[_._v("\\ds")]),_._v(" 只显示序列")]),_._v(" "),s("li",[s("code",[_._v("\\dv")]),_._v(" 只显示视图")]),_._v(" "),s("li",[s("code",[_._v("\\df")]),_._v(" 只显示函数")]),_._v(" "),s("li",[s("code",[_._v("\\dn")]),_._v(" 只显示 schema 架构模式")]),_._v(" "),s("li",[s("code",[_._v("\\du")]),_._v(" 或 "),s("code",[_._v("\\dg")]),_._v(" 显示角色或用户，以及其具有的属性")]),_._v(" "),s("li",[s("code",[_._v("\\dp")]),_._v(" 或 "),s("code",[_._v("\\z")]),_._v(" 显示表的权限分配")])]),_._v(" "),s("h3",{attrs:{id:"encoding-命令"}},[_._v("\\encoding 命令")]),_._v(" "),s("p",[_._v("以 "),s("code",[_._v("\\encoding")]),_._v(" 为关键字的命令设置客户端的数据内容编码模式，一般不需要修改（除非输出时出现字符乱码）")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("\\encoding gbk;")]),_._v(" 一般需要显示中文时需要将客户端设置为 "),s("code",[_._v("gbk")]),_._v(" 编码模式")]),_._v(" "),s("li",[s("code",[_._v("\\encoding utf8;")]),_._v(" 如果数据文档是使用 UTF-8 进行编码的，可以将客户端切换为 "),s("code",[_._v("utf8")]),_._v(" 编码模式，这样就可以避免由于客户端编码模式与服务器编码模式不一致，从数据库读取数据需要转码可能引起的错误")]),_._v(" "),s("li",[s("code",[_._v("CREATE DATABASE test WITH ENCODING 'utf8';")]),_._v(" 创建一个库 "),s("code",[_._v("test")]),_._v(" 并使用 "),s("code",[_._v("utf8")]),_._v(" 编码")])]),_._v(" "),s("h3",{attrs:{id:"pset-命令"}},[_._v("\\pset 命令")]),_._v(" "),s("p",[_._v("以 "),s("code",[_._v("\\pset")]),_._v(" 为关键字的命令设置输出格式，如输出的表格的边框样式")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("\\pset border 0;")]),_._v(" 输出内容无边框")]),_._v(" "),s("li",[s("code",[_._v("\\pset border 1;")]),_._v(" 只显示内边框")]),_._v(" "),s("li",[s("code",[_._v("\\pset border 2;")]),_._v(" 内外都有边框")])]),_._v(" "),s("h3",{attrs:{id:"x-命令"}},[_._v("\\x 命令")]),_._v(" "),s("p",[_._v("以 "),s("code",[_._v("\\x")]),_._v(" 命令切换表格数据按照单行或二维数组显示的状态")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("\\x")]),_._v(" 当反馈输出的结果为 "),s("code",[_._v("Expanded display is on")]),_._v(" 表示扩展显示开启，数据按单行模式显示")]),_._v(" "),s("li",[s("code",[_._v("\\x")]),_._v(" 当反馈输出的结果为 "),s("code",[_._v("Expanded display is off")]),_._v(" 表示扩展显示关闭，数据按二维数组模式显示")])]),_._v(" "),s("h3",{attrs:{id:"c-命令"}},[_._v("\\c 命令")]),_._v(" "),s("p",[_._v("以 "),s("code",[_._v("\\c")]),_._v(" 为关键字的命令切换数据库/用户")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("\\c databaseName;")]),_._v(" 切换数据库")]),_._v(" "),s("li",[s("code",[_._v("\\c - username;")]),_._v(" 在当前数据库中切换用户")]),_._v(" "),s("li",[s("code",[_._v("\\c database username;")]),_._v(" 切换数据库和用户")])]),_._v(" "),s("h3",{attrs:{id:"h-命令"}},[_._v("\\h 命令")]),_._v(" "),s("p",[_._v("以 "),s("code",[_._v("\\h")]),_._v(" 为关键字的命令显示帮助信息")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("\\h")]),_._v(" 显示所有 SQL 命令")]),_._v(" "),s("li",[s("code",[_._v("\\h *;")]),_._v(" 显示全部命令")]),_._v(" "),s("li",[s("code",[_._v("\\h 命令名称;")]),_._v(" 显示该命令名称的帮助信息")])]),_._v(" "),s("p",[_._v("💡 shell 通用的终止进程的快捷键是 "),s("code",[_._v("Ctrl + C")]),_._v("，一般显示的帮助信息都十分长，当阅读部分的信息可以解决问题后，可以按快捷键 "),s("code",[_._v("Ctrl + C")]),_._v(" 关闭该进程。")]),_._v(" "),s("h2",{attrs:{id:"用户权及限管理"}},[_._v("用户权及限管理")]),_._v(" "),s("p",[_._v("数据库可能有多个用户管理，可以为每个用户设置不同的使用权限，如创建功能，操作表格功能等。")]),_._v(" "),s("h3",{attrs:{id:"创建与删除用户"}},[_._v("创建与删除用户")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("CREATE ROLE rolename;")]),_._v(" 创建角色")]),_._v(" "),s("li",[s("code",[_._v("CREATE USER username;")]),_._v(" 创建用户")])]),_._v(" "),s("p",[_._v("💡 用户 "),s("code",[_._v("USER")]),_._v(" 默认是有登录权限的，也可以设置登陆密码；而角色 "),s("code",[_._v("ROLE")]),_._v(" 没有登陆权限的。")]),_._v(" "),s("ul",[s("li",[s("p",[s("code",[_._v("DROP ROLE rolename;")]),_._v(" 删除角色")])]),_._v(" "),s("li",[s("p",[s("code",[_._v("DROP USER username;")]),_._v(" 删除用户")])]),_._v(" "),s("li",[s("p",[s("code",[_._v("\\du")]),_._v(" 或 "),s("code",[_._v("\\du userName")]),_._v(" 查看所有已创建的用户或名为 userName 的属性")])]),_._v(" "),s("li",[s("p",[s("code",[_._v("\\du CREATE ROLE;")]),_._v(" 或 "),s("code",[_._v("\\du CREATE USER;")]),_._v(" 查看可设置的管理权限")])]),_._v(" "),s("li",[s("p",[s("code",[_._v("CREATE ROLE role_name WITH optional_permissions;")]),_._v(" 在创建用户时设定权限")]),_._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[_._v("-- 创建超级用户")]),_._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("CREATE")]),_._v(" ROLE r1 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("WITH")]),_._v(" SUPERUSER"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("CREATE")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("USER")]),_._v(" u1 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("WITH")]),_._v(" PASSWORD "),s("span",{pre:!0,attrs:{class:"token string"}},[_._v("'abc'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v("\n")])])])])]),_._v(" "),s("p",[_._v("💡 常用的权限如下：")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("SUPERUSER")]),_._v(" 或 "),s("code",[_._v("NOSUPERUSER")]),_._v(" 超级用户，⚠️ 只有超级用户可以创建超级用户")]),_._v(" "),s("li",[s("code",[_._v("CREATEDB")]),_._v(" 或 "),s("code",[_._v("NOCREATEDB")]),_._v(" 创建出来的用户是否有执行 CREATE DATABASE 的权限")]),_._v(" "),s("li",[s("code",[_._v("CREATEROLE")]),_._v(" 或 "),s("code",[_._v("NOCREATEROLE")]),_._v(" 创建出来的用户是否有创建其他角色的权限")]),_._v(" "),s("li",[s("code",[_._v("LOGIN")]),_._v(" 或 "),s("code",[_._v("NOLOGIN")]),_._v(" 创建出来的用户是否有Login的权限")]),_._v(" "),s("li",[s("code",[_._v("INHERIT")]),_._v(" 或 "),s("code",[_._v("NOINHERIT")]),_._v(" 如果创建的一个用户拥有某一个或某几个角色，若指定 "),s("code",[_._v("INHERIT")]),_._v("，则表示该用户自动拥有相应角色的权限")]),_._v(" "),s("li",[s("code",[_._v("CONNECTION LIMIT")]),_._v(" 或 "),s("code",[_._v("connlimit")]),_._v(" 该用户可以使用的并发连接数量，默认值为 "),s("code",[_._v("-1")]),_._v("，表示没有限制")])]),_._v(" "),s("h3",{attrs:{id:"切换用户"}},[_._v("切换用户")]),_._v(" "),s("ul",[s("li",[s("code",[_._v("\\c - username;")]),_._v(" 在当前的数据库中切换用户")]),_._v(" "),s("li",[s("code",[_._v("\\c database username;")]),_._v(" 切换数据库和用户")])]),_._v(" "),s("h3",{attrs:{id:"设置用户权限"}},[_._v("设置用户权限")]),_._v(" "),s("p",[s("code",[_._v("GRANT permission_type ON table_name TO role_name;")]),_._v(" 给用户 role_name 设置特定的权限类型 permission_type（对于表格 table_name 的操作权限）")]),_._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("GRANT")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("UPDATE")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("ON")]),_._v(" room "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("TO")]),_._v(" u1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[_._v("-- 给u1对于room表格，赋予UPDATE权限")]),_._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("GRANT")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("ALL")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("ON")]),_._v(" room "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("TO")]),_._v(" u1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[_._v("-- 给u1对于room表格，赋予所有权限")]),_._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("GRANT")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("SELECT")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("ON")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("ALL")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("TABLES")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[_._v("IN")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("SCHEMA")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("PUBLIC")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("TO")]),_._v(" u1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[_._v("-- 给u1对于postgres数据库所有表格，赋予SELECT权限")]),_._v("\n")])])]),s("h3",{attrs:{id:"修改用户权限"}},[_._v("修改用户权限")]),_._v(" "),s("p",[s("code",[_._v("ALTER ROLE username WITH attribute_options;")]),_._v(" 修改权限的命令格式")]),_._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("ALTER")]),_._v(" ROLE r1 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("WITH")]),_._v(" CREATEDB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("ALTER")]),_._v(" ROLE u1 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("WITH")]),_._v(" PASSWORD "),s("span",{pre:!0,attrs:{class:"token string"}},[_._v("'aaa'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v("\n")])])]),s("h3",{attrs:{id:"撤销权限"}},[_._v("撤销权限")]),_._v(" "),s("p",[s("code",[_._v("REVOKE permission_type ON table_name FROM user_name;")]),_._v(" 撤销用户 user_name 的权限 permission_type（对于表格 table_name 的操作权限）")]),_._v(" "),s("div",{staticClass:"language-sql extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("REVOKE")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("SELECT")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("ON")]),_._v(" room "),s("span",{pre:!0,attrs:{class:"token keyword"}},[_._v("FROM")]),_._v(" u1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(";")]),_._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[_._v("-- 撤销u1对room表格 SELECT的权限")]),_._v("\n")])])])])}),[],!1,null,null,null);v.default=t.exports},808:function(_,v,e){_.exports=e.p+"assets/pdf/postgresql-12-A4.pdf"}}]);