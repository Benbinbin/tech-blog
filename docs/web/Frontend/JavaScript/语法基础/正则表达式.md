---
tags:
  - javascript
  - regexp
---

# 正则表达式
参考：
* [正则表达式 - JavaScript | MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions)
* [RegExp - JavaScript | MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp#character-classes)
* [JS正则表达式完整教程（略长）](https://juejin.im/post/5965943ff265da6c30653879) | [pdf](./_v_attachments/20191130210203760_3964/JavaScript-RegExp-mini-book-v1.1.pdf)

正则表达式是使用普通字符或普通字符与特殊字符组成的文字模式，该模式用于查找匹配字符串中字符组合。在 JavaScript中，正则表达式也是对象。

## 创建正则表达式

**方法一：正则表达式字面量**

使用一个正则表达式字面量创建正则表达式，其由包含在斜杠 `//` 之间的模式组成。该形式构建的正则表达式在脚本加载时编译，当正则表达式保持不变时，使用此方法可获得更好的性能。

示例
```javascript
var re = /ab+c/;
```

**方法二：构造函数 `RegExp()`**

调用 RegExp 对象的构造函数 `RegExp()` 创建正则表达式。以字符串形式（使用双引号 `""` 输入）。该形式构建的正则表达式在脚本运行时编译，当你知道正则表达式的模式将会改变，或者你不知道模式，并且从其他来源获取它，如用户输入，可使用该方法。

示例
```javascript
car re = new RegExp("ab+c");
```

**注意**：当使用构造函数创造正则对象时，需要常规的字符转义规则（在前面加反斜杠 `\`）

```javascript
// 以下是等价正则表达式
var re = new RegExp("\\w+");
var re = /\w+/;
```

## 基本语法
一个正则表达式模式是由简单的字符或者是简单和特殊字符的组合。

**简单模式**是由想直接找到的字符构成，如 `/abc/` 这个模式就能且仅能匹配 `abc` 字符**按照顺序同时出现**的情况。当你需要搜索一个比直接匹配需要更多条件的匹配时，可以在模式中使用特殊字符。

**常见的特殊符号**

| 特殊字符 |                                    含义                                    |                                                                                                                                                  注释                                                                                                                                                  |
| ------- | -------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `\`     | 转义符                                                                     | 在非特殊字符之前表示下一个字符是特殊字符，不能按照字面理（相反在特殊字符之前表示下一个字符不是特殊字符，应该按照字面理解）。**如果你想将字符串传递给 RegExp 构造函数，不要忘记在字符串字面量中反斜杠是转义字符。**                                                                                                 |
| `^`     | 匹配输入的**开始**                                                          | `/^A/` 不会匹配 `an A` 中的 `A`，匹配 `An E` 中的 `A`                                                                                                                                                                                                                                                    |
| `$`     | 匹配输入的**结束**                                                          | `/t$/` 不会匹配 `eater` 中的 `t`，匹配 `eat` 中的 `t`                                                                                                                                                                                                                                                    |
| `\b`    | 匹配一个零宽**单词边界** zero-width word boundary，如一个字母与一个空格之间。 | `/\bno/` 匹配 `at noon` 中的 `no`，`/ly\b/` 匹配 `possibly yesterday.` 中的 `ly`                                                                                                                                                                                                                        |
| `*`     | 匹配前一个表达式 0 次或多次****。等价于 `{0,}`                               | `/bo*/` 会匹配 `A ghost boooooed` 中的 `booooo` 和 `A bird warbled` 中的 `b`                                                                                                                                                                                                                            |
| `+`     | 匹配前面一个表达式 **1 次或者多次**。等价于 `{1,}`                           | `/a+/` 会匹配 `candy` 中的 `a` 和 `caaaaaaandy` 中所有的 `a`                                                                                                                                                                                                                                            |
| `?`     | 匹配前面一个表达式 **0 次或者 1 次**。等价于 {0,1}。                         | `/e?le?/` 匹配 `angel` 中的 `el`、`angle` 中的 `le` 以及 `oslo` 中的 `l`。如果紧跟在任何量词 *、 +、? 或 {} 的后面，将会使量词变为**非贪婪（匹配尽量少的字符）**，和缺省使用的贪婪模式（匹配尽可能多的字符）正好相反。`123abc` 使用 `/\d+/` 将会匹配 `123`，而使用 `/\d+?/` 则只会匹配到 `1`。还用于**先行断言中**。 |
| `.`     | （小数点）默认匹配除换行符之外的**任何单个字符**                              |                                                                                                                                                                                                                                                                                                        |

**常见的特殊字符**

| 字符 |                                    含义                                    |                               注释                               |
| ---- | ------------------------------------------------------------------------- | --------------------------------------------------------------- |
| `\d` | 匹配任意阿拉伯数字。等价于[0-9]。                                            |                                                                 |
| `\w` | 匹配任意来自基本拉丁字母表中的字母数字字符，还包括下划线。等价于 [A-Za-z0-9_]。 | `/\w/` 匹配 `apple` 中的 `a`，`$5.28` 中的 `5` 和 `3D` 中的 `3`。 |
| `\s` | 匹配一个空白符，包括空格、制表符、换页符、换行符和其他 Unicode 空格            |                                                                 |
| `\t` | 	匹配一个水平制表符（tab）                                                  |                                                                 |
| `\r` | 	匹配一个回车符（carriage return）                                          |                                                                 |
| `\n` | 	匹配一个换行符（linefeed）                                                 |                                                                 |

**常见字符集合**

|  字符集  |                                       含义                                        |                                注释                                |
| -------- | --------------------------------------------------------------------------------- | ----------------------------------------------------------------- |
| `[xyz]`  | 一个字符集合，也叫字符组。匹配集合中的任意一个字符。你可以使用连字符 `-` 指定一个范围。 | `[abcd]` 等价于 `[a-d]`，匹配 `brisket` 中的 `b` 和 `chop` 中的 `c` |
| `[^xyz]` | 一个反义或补充字符集，也叫反义字符组。也就是说，它匹配任意不在括号内的字符。            |                                                                   |

## 分组 Grouping 与引用 references
### 分组
使用括号 `(regex)` 表示分组，并且捕获 regex 匹配项，以供反向引用

示例
```javascript
var regex = /(\d{4})-(\d{2})-(\d{2})/;
var string = "2017-06-12";

// 方法 replace 中第二个参数里用 $1、$2、$3 指代相应的分组
var result = string.replace(regex, "$2/$3/$1");
console.log(result); // "06/12/2017"
```

## 断言 Assertions
参考：[Assertions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Assertions)

一类特殊字符的组合，以表示满足某些条件的匹配模式。断言包含先行断言 look-ahead、后行断言 look-behind 和条件表达式 conditional expressions。

### 先行断言
模式 `x(?=y)`

表示 `y` 紧跟 `x` 的情况下匹配 `x`（匹配结果不包括 `y`)

示例
```javascript
// Jack 后跟有 Sprat 或 Frost 的情况下才会得到匹配。不过匹配结果不包括 Sprat 或 Frost
/Jack(?=Sprat|Frost)/
```

### 负向先行断言
模式 `x(?!y)`

表示 `x` 后无 `y` 紧随的情况下匹配 `x`

示例
```javascript
// 匹配一个后面没有小数点跟随的数字
/\d+(?!\.)/
```

### 后行断言
模式 `(?<=y)x`

表示 `x` 紧随 `y` 的情况下匹配 `x`

示例
```javascript
// Sprat 在紧随 Jack 或 Tom 的情况下才会得到匹配
/(?<=Jack|Tom)Sprat/
```

### 负向后行断言
模式 `(?<!y)x`

表示 `x` 不紧随 `y` 的情况下匹配 `x`

示例
```javascript
// 数字没有跟随在负值符号 - 后面才匹配
/(?<!-)\d+/
```

## 模式修饰符
模式修饰符用于控制匹配的相关方式，放置在正则表达式最后一个 `/` 外侧
* `i` ignoreCase 忽略大小写
* `g` global 全局匹配
* `m` multiline 多行匹配